<!DOCTYPE html><!--if lt IE 7<html class="ie ie6" lang="en">--><!--if IE 7<html class="ie ie7" lang="en">--><!--if IE 8<html class="ie ie8" lang="en">--><!--if (gte IE 9)|!(IE)<!--><html lang="en"> <!--
--><html><head><meta charset="utf8"><title> &middot; SAFETAG</title><meta name="description" content=""><meta name="author" content=""><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><link href="/safetag/@safetag/toolkit/filter.js/assets/css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css"><link href="/safetag/@safetag/toolkit/filter.js/assets/css/jquery-ui-1.10.2.custom.min.css" media="screen" rel="stylesheet" type="text/css"><link href="/safetag/@safetag/toolkit/filter.js/assets/css/stream.css" media="screen" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/safetag/@safetag/toolkit/css/skeleton.css"><link rel="stylesheet" href="/safetag/@safetag/toolkit/css/selection.css"><link rel="stylesheet" href="/safetag/@safetag/toolkit/css/site.css"><script src="/safetag/@safetag/toolkit/filter.js/assets/js/jquery-1.11.3.min.js" type="text/javascript"></script><script src="/safetag/@safetag/toolkit/filter.js/assets/js/jquery-ui-1.10.2.custom.min.js" type="text/javascript"></script><script src="/safetag/@safetag/toolkit/filter.js/assets/js/jquery-ui-1.10.2.custom.min.js" type="text/javascript"></script><script src="/safetag/@safetag/toolkit/js/js-yaml.min.js"></script><script src="/safetag/@safetag/toolkit/js/sortable.min.js"></script><script src="/safetag/@safetag/toolkit/js/lodash.min.js"></script><script src="/safetag/@safetag/toolkit/js/filter.js"></script><script src="/safetag/@safetag/toolkit/js/anchor.min.js"></script><script src="/safetag/@safetag/toolkit/js/site.js"></script><link rel="shortcut icon" href="/safetag/@safetag/toolkit/images/favicon.ico"><link rel="apple-touch-icon" href="/safetag/@safetag/toolkit/images/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="72x72" href="/safetag/@safetag/toolkit/images/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="114x114" href="/safetag/@safetag/toolkit/images/apple-touch-icon-114x114.png"><link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lora:400,300,600" rel="stylesheet" type="text/css"><link rel="alternate" type="application/rss+xml" title="RSS" href="/safetag/@safetag/toolkit/atom.xml"></head><div class="navbar-spacer"></div><nav class="navbar navbar-fixed-top"><div class="container"><ul class="navbar-list"><li class="navbar-item"><a class="navbar-link" href="/safetag/@safetag/toolkit/">Home</a></li><li class="navbar-item"><a class="navbar-link" href="#" data-popover="#codeNavAbout">Methods</a><div class="popover" id="codeNavAbout"><ul class="popover-list"><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/preparation.guide.html">Preparation</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/context_research.guide.html">Context Research</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/capacity_assessment.guide.html">Capacity Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/reconnaissance.guide.html">Reconnaissance</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/network_discovery.guide.html">Network Discovery</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/network_access.guide.html">Network Access</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/network_mapping.guide.html">Network Mapping</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/user_device_assessment.guide.html">User Device Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/vulnerability_scanning.guide.html">Vulnerability Scanning and Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/data_assessment.guide.html">Data Asssessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/physical_assessment.guide.html">Physical Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/risk_modeling.guide.html">Process Mapping and Risk Modeling</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/threat_assessment.guide.html">Threat Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/responsive_support.guide.html">Responsive Support</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/toolkit/methods/follow_up.guide.html">Follow Up</a></li></ul></div></li><li class="navbar-item u-pull-right hidden" id="cd-cart-trigger"><a class="navbar-link cd-img-replace cd-cart" href="#0">Plan<i class="glyphicon glyphicon-list-alt"><span>0</span></i></a></li></ul></div></nav><body class="has-docked-nav" data-baseurl="/safetag/@safetag/toolkit"><div class="container"><div class="docs-section"><div class="space"> </div><div class="boxtext">
:<a href="../../activities/device_checklist/index.md"></a>
</div>
<div class="boxtext">
:<a href="../../activities/day_in_the_life/index.md"></a>
</div>
<div class="boxtext">
<!-- Following snippet transcluded from activities/firewire/index.md with resolveMetalsmith.url(../../activities/firewire/index.md) {"id":"firewire","name":"Firewire Access to Encrypted/Locked computers","description":"Firewire ports and expansion slots can be abused to obtain data that are thought to be encryptedAny attacker who...","duration":2,"template":{"minimum-viable":[{"walk-around":"small-office"},{"interview":"3-interviewees"}]},"framework":["User Device Assessment"]} -->
<h1 id="firewire-access-to-encryptedlocked-computers">Firewire Access to Encrypted/Locked computers</h1>
<h2 id="summary">Summary</h2>
<p>Firewire ports and expansion slots can be abused to obtain data that are thought to be encrypted</p>
<p>Any attacker who obtains a running (including sleeping and hibernating!) Windows, Mac, or even Linux laptop with a Firewire port, an ExpressCard expansion slot, or a Thunderbolt port will be able to read, record or modify any sensitive information on the device, even if the screen is “locked” and the information is stored on an encrypted volume or in an encrypted folder. This applies to threats involving loss, theft and confiscation, but also to “checkpoint” scenarios in which the attacker may only have access for a few minutes.</p>
<p>This attack requires physical control of a machine that is not powered off. Full details of the scope of the attack are available at <a href="http://www.breaknenter.org/projects/inception/" class="uri">http://www.breaknenter.org/projects/inception/</a> .</p>
<h2 id="materials-needed">Materials Needed</h2>
<ul>
<li>A system with a firewire port, a thunderbolt port, or a PCMCIA slot and a firewire card. See <a href="http://www.breaknenter.org/projects/inception/#Requirements" class="uri">http://www.breaknenter.org/projects/inception/#Requirements</a></li>
</ul>
<h2 id="walkthrough">Walkthrough</h2>
<p>Firewire ports and expansion slots can be abused to obtain data that are thought to be encrypted</p>
<p>The threat describe in this section is more complex than it needs to be. In fact, unencrypted data are vulnerable to any number of simple attacks, the two most straightforward being: 1) rebooting the computer from a USB stick CD-ROM or DVD containing an alternate operating system, then copying all of the data; or 2) removing the hard drive, inserting it into a different machine, then copying all of the data. These techniques, which work on nearly any computer, even if a strong login password has been set, are effective and widely used, but they require extended physical access to the device. A slightly different attack is described below, one that only requires physical access for a few minutes. It, too, works regardless of login/screen-lock passwords, though only devices with Firewire ports or expansion slots (ExpressCard, CardBus, PCMCIA, etc.) are vulnerable.</p>
<p>The steps required to defend against all of these threats is the same: encrypt your data using a tool like Microsoft’s BitLocker, Apple’s FileVaule or the open-source Truecrypt application. The Firewire attack highlighted here is particularly illustrative, however, because it serves as a reminder that merely setting up an encrypted volume is not enough. In much the same way that a lock does little to protect your home if the door to which it is attached remains open, data encryption is rarely effective while you are logged into your computer. Even if the screen is locked (which would foil the “reboot” and “hard drive removal” attacks described briefly above), an attacker may still find a way to access your sensitive data, while the computer is up and running, because the decryption key is present in the computer’s memory. (This is how large-scale encryption actually works. Information remains encrypted at all times, on the storage device where it lives, but you are able to access it while you are logged in, or while your encrypted volume is “open,” because your computer decrypts and encrypts it on the fly.)<br />
Walkthrough</p>
<p>Step 1: First, the attacker would connect her computer to the victim’s using a Firewire cable. Either or both machines could be using a true Firewire port or a Firewire expansion card. When a Firewire ExpressCard expansion card is inserted, Windows automatically installs and configures the necessary drivers, even if nobody is logged into the laptop.</p>
<p>Step 2: Once connected, the attacker simply runs the Inception tool, selects the operating system of the target machine and waits a minute or two for the attack to complete (depending on the amount of RAM present):</p>
<pre><code>$ incept

 _|  _|      _|    _|_|_|  _|_|_|_|  _|_|_|    _|_|_|  _|    _|_|    _|      _|
 _|  _|_|    _|  _|        _|        _|    _|    _|    _|  _|    _|  _|_|    _|
 _|  _|  _|  _|  _|        _|_|_|    _|_|_|      _|    _|  _|    _|  _|  _|  _|
 _|  _|    _|_|  _|        _|        _|          _|    _|  _|    _|  _|    _|_|
 _|  _|      _|    _|_|_|  _|_|_|_|  _|          _|    _|    _|_|    _|      _|

v.0.2.0 (C) Carsten Maartmann-Moe 2012
Download: http://breaknenter.org/projects/inception | Twitter: @breaknenter

[*] FireWire devices on the bus (names may appear blank):
--------------------------------------------------------------------------------
[1] Vendor (ID): MICROSOFT CORP. (0x50f2) | Product (ID):  (0x0)
--------------------------------------------------------------------------------
[*] Only one device present, device auto-selected as target
[*] Selected device: MICROSOFT CORP.
[*] Available targets:
--------------------------------------------------------------------------------
[1] Windows 8: msv1_0.dll MsvpPasswordValidate unlock/privilege escalation
[2] Windows 7: msv1_0.dll MsvpPasswordValidate unlock/privilege escalation
[3] Windows Vista: msv1_0.dll MsvpPasswordValidate unlock/privilege escalation
[4] Windows XP: msv1_0.dll MsvpPasswordValidate unlock/privilege escalation
[5] Mac OS X: DirectoryService/OpenDirectory unlock/privilege escalation
[6] Ubuntu: libpam unlock/privilege escalation
--------------------------------------------------------------------------------
[!] Please select target (or enter &#39;q&#39; to quit): 2
[*] Selected target: Windows 7: msv1_0.dll MsvpPasswordValidate unlock/privilege escalation
[*] Initializing bus and enabling SBP-2, please wait  1 seconds or press Ctrl+C
[*] DMA shields should be down by now. Attacking...
[*] Searching, 1328 MiB so far
[*] Signature found at 0x8b50c321 (in page # 570636)
[*] Write-back verified; patching successful
[*] BRRRRRRRAAAAAWWWWRWRRRMRMRMMRMRMMMMM!!!</code></pre>
<p><em>In the case of the laptops tested, Inception took approximately two minutes to reach the final, somewhat self-congratulatory line shown above. At that point, we were able to login using any password. (Entering “asdf” worked just fine, and gave us full access to all data on the computer.) Inception works by temporarily replacing authentication code using the Firewire’s protocol’s direct memory access (DMA). After a reboot, everything is restored to its original state.</em></p>
<p>Once again, it is worth noting that successful mitigation of this issue requires a combination of technology (data encryption) and some level of behavior change (shutting down laptops at the end of the day, when traveling and at any time when confiscation, theft, loss or tampering are particularly likely.)</p>
<h5 id="material-that-may-be-useful">Material that may be Useful:</h5>
<!-- End of transcluded snippet from activities/firewire/index.md -->
</div>
<div class="boxtext">
:<a href="../../activities/password_security/index.md"></a>
</div>
<div class="boxtext">
<h3 id="physical-security-guided-tour">Physical Security Guided Tour</h3>
<p>Covered in full in Physical Assessment:</p>
:<a href="../../activities/guided_tour/approach.md"></a>
</div>
<div class="boxtext">
:<a href="../../activities/check_user_browser_vulns/index.md"></a>
</div>
</div><div class="browse-section"><h1>Browse<span id="total_results"> </span></h1><div class="sidebar col-md-3"><div><label class="sr-only" for="searchbox">Search</label><input class="form-control" id="searchbox" type="text" placeholder="Search …"><span class="glyphicon glyphicon-search search-icon"></span></div><br><div class="well"><fieldset id="framework_criteria"><legend>Framework categories</legend></fieldset></div><div class="well"><fieldset id="activity_criteria"><legend>Activity</legend></fieldset></div><div class="well"><fieldset id="context_criteria"><legend>Context</legend></fieldset></div><div class="well"><fieldset id="tool_criteria"><legend>Tool needed</legend></fieldset></div></div><div class="col-md-9"><div class="movies content row" id="results"> </div></div></div><script id="result-template" type="text/html"><% var metadata = Object.assign({}, arguments[0]); %>
<div class="col-md-4 movie" data-activity='<%= JSON.stringify(arguments[0]) %>'>
  <div class="thumbnail">
    <button class="label label-success rating add-to-cart hidden">
      <span>Add 
        <i class="glyphicon glyphicon-plus"></i>
      </span>
      <svg x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32">
      	<path stroke-dasharray="19.79 19.79" stroke-dashoffset="19.79" fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" d="M9,17l3.9,3.9c0.1,0.1,0.2,0.1,0.3,0L23,11"/>
      </svg>
    </button>
    <div class="caption">
      <a href="<%= baseurl %>/activities/<%= id %>"><h4><%= name %></h4></a>
      <div class="detail">
        <%= description %>
        <span class="runtime">
          <i class="glyphicon glyphicon-time"></i>
          <!-- // Calculate time interval from variations and defaults to explicit duration. -->
          <!-- // Task based calculation. Object.keys(tasks).reduce(function(sum, task) { var varDurations = Object.keys(tasks[task].variations || {}).map(function(variation) { return tasks[task].variations[variation].duration }); return [(varDurations.length !== 0 ? Math.min(...varDurations) : tasks[task].duration ) < sum[0] ? (varDurations.length !== 0 ? Math.min(...varDurations) : tasks[task].duration ) : sum[0], (varDurations.length !== 0 ? Math.max(...varDurations) : tasks[task].duration ) > sum[1] ? (varDurations.length !== 0 ? Math.max(...varDurations) : tasks[task].duration ) + sum[1] : sum[1]] },[9999,0]).join(' ~ ') || duration || "?" -->
          <%= ((arguments[0].variations && variations.length !== 0) ? variations.reduce(function(sum, variation) { return [ variation.duration < sum[0] ? variation.duration : sum[0], variation.duration > sum[1] ? variation.duration + sum[1] : sum[1]] }, [9999,0]).join(' ~ ') : duration) || "?" %> hours.
        </span>
      </div>
      <div class="outline">
        <!-- // Ignore non relevant keys and print metadata key value pairs -->
        <span><%= Object.keys(metadata).filter(function(key) {return !["id", "name", "baseurl", "variations", "_fid", "path", "content_type", "description", "duration"].includes(key) }).map(function(key) { return '<strong>' + key + '</strong><br>' + metadata[key] }).join('<br>') %></span>
      </div>
    </div>
  </div>
</div>
</script><script src="/safetag/@safetag/toolkit/js/browse.js"></script></div></body><div class="section categories"><div class="container"><div class="row"><div class="two columns">&nbsp;</div><div class="eight column category"><h4>Developed with ❤ by</h4><a href="https://iilab.org"><img class="u-max-full-width" src="/safetag/@safetag/toolkit/images/iilab_white.svg"></a><h5>Information Innovation Lab</h5><p>Applied research and development of public interest technology.</p></div><div class="two columns">&nbsp;</div></div></div></div><script>$( document ).ready(function() {
  anchors.options.placement = 'left';
  anchors.add('h1,h2,h3');
})
</script><script src="http://localhost:35730/livereload.js"></script></html>